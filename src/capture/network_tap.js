(function(NS){ function install(cb){ const code=`(function(){ if(window.__LC_NET_TAP_V2__)return; window.__LC_NET_TAP_V2__=true; const F=window.fetch; function pick(t){const o={customInput:'',typedCode:'',lang:''};try{ if(!t) return o; const parseKV=kv=>{const v=kv||{}; const vars=v.variables||v; o.customInput=vars.input||vars.testCase||vars.testcase||vars.data_input||vars.customInput||o.customInput; o.typedCode=vars.typed_code||vars.code||o.typedCode; o.lang=vars.lang||vars.language||vars.langSlug||o.lang;}; if(t.startsWith('{')) parseKV(JSON.parse(t)); else { const p=new URLSearchParams(t); o.customInput=p.get('input')||p.get('testCase')||p.get('testcase')||p.get('data_input')||p.get('customInput')||o.customInput; o.typedCode=p.get('typed_code')||p.get('code')||o.typedCode; o.lang=p.get('lang')||p.get('language')||p.get('langSlug')||o.lang; } }catch{} return o;} window.fetch=async function(input, init){ try{ const url=(typeof input==='string')?input:input.url; const method=(init?.method||input?.method||'GET').toUpperCase(); const path=new URL(url,location.href).pathname; const interesting=((/(submissions|interpret|run|judge|execute|check|runcase|submit)/i.test(url)&&method==='POST') || (/\\/graphql\\/?$/.test(path)&&method==='POST')); if(interesting){ let body=''; if(typeof init?.body==='string') body=init.body; else if(init?.body instanceof URLSearchParams) body=init.body.toString(); else if(init?.body instanceof FormData){ const o={}; for(const [k,v] of init.body)o[k]=v; body=JSON.stringify(o);} else if(input && input.bodyUsed===false && input.clone){ try{ body=await input.clone().text(); }catch{} } const picked=pick(body); window.dispatchEvent(new CustomEvent('lc-input-v2',{detail:picked})); } }catch(e){} return F.apply(this, arguments); }; })();`; const s=document.createElement('script'); s.textContent=code; document.documentElement.appendChild(s); s.remove(); window.addEventListener('lc-input-v2', ev=>{ try{ cb(ev.detail||{customInput:'',typedCode:'',lang:''}); }catch{} }); } NS.capture.networkTap={ install }; })(window.LCMD);
